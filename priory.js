const CacheName="schwarzschild",CacheUrl=["/","/index.html","/404.png","/favicon.ico","/webapp.json"],cacheResource=async(e,r)=>{var a=await caches.open(CacheName);await a.put(e,r)};self.addEventListener("install",e=>{console.log("[:>  SW Installed <:]"),e.waitUntil(async()=>{await caches.delete(CacheName);var r=await caches.open(CacheName);await r.addAll(CacheUrl)})}),self.addEventListener("fetch",e=>{if(e.request.method==="GET"&&!!e.request.url.match(/^https?:\/\//i)&&!(e.request.url.indexOf(self.location.origin)<0)){var r=e.request.url.replace(self.location.origin,""),a=r.split("/"),c=a[a.length-1];a.pop(),a=a.join("/"),c!=="priory.js"&&(c.match(/(mp3|mp4|wav|avi|rm|rmvb)$/i)||!!a.match(/^[\/\\]*api[\/\\]/i)||!!a.match(/^[\/\\]*api$/i)||(caches.open(CacheName).then(t=>t.add(r)),e.respondWith(caches.match(e.request).then(t=>{if(t)return t;var i=fetch(e.request).then(n=>(cacheResource(e.request,n.clone()).then(()=>{console.log("CacheUpaded: "+e.request.url)}),n)).catch(n=>{console.error("Fetch Failed: "+e.request.url),console.error(n)});return i}))))}});
