(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52bc38f8"],{"266f":function(e,a,t){},a647:function(e,a,t){"use strict";t("fe7e")},dcfb:function(e,a,t){"use strict";t.r(a);var s=t("79c4");const i=Object(s["G"])("data-v-4e9c4353"),n=i((e,a,t,i,n,r)=>{const c=Object(s["x"])("Crumb"),l=Object(s["x"])("Tabs"),o=Object(s["x"])("Uploader");return Object(s["q"])(),Object(s["d"])(s["a"],null,[Object(s["h"])(c,{target:"tools"}),Object(s["h"])(l,{tabs:n.pages,showNewTab:!0,selected:n.currentTab,onSelect:r.onSelect,onNewTab:r.newPage,onClose:r.closeTab},null,8,["tabs","selected","onSelect","onNewTab","onClose"]),Object(s["h"])(o,{ref:"uploader",type:".mu,.md",onParse:r.parseFile},null,8,["onParse"]),Object(s["h"])("div",{ref:"articleArea",class:"content-container",onClick:a[1]||(a[1]=(...e)=>r.onClick&&r.onClick(...e))},null,512)],64)}),r={class:"tab_container"},c=Object(s["h"])("i",{class:"fas fa-plus"},null,-1);function l(e,a,t,i,n,l){return Object(s["q"])(),Object(s["d"])("div",r,[(Object(s["q"])(!0),Object(s["d"])(s["a"],null,Object(s["w"])(t.tabs,e=>(Object(s["q"])(),Object(s["d"])("div",{class:"tab_item",selected:e.key===t.selected,onClick:a=>l.select(e),onDblclick:a=>l.close(e)},Object(s["z"])(e.name),41,["selected","onClick","onDblclick"]))),256)),t.showNewTab?(Object(s["q"])(),Object(s["d"])("div",{key:0,class:"tab_item tab_new_item",onClick:a[1]||(a[1]=(...e)=>l.newTab&&l.newTab(...e))},[c])):Object(s["e"])("",!0)])}loadCSS("/css/tabs.css");var o=null,h={name:"Tabs",props:{tabs:Array,showNewTab:Boolean,selected:String},methods:{select(e){o&&(clearTimeout(o),o=null),e.key!==this.selected&&(o=setTimeout(()=>{this.$emit("select",e)},100))},newTab(){o&&(clearTimeout(o),o=null),this.$emit("newTab")},close(e){o&&(clearTimeout(o),o=null),this.$emit("close",e)}}};h.render=l;var u=h;const p=Object(s["G"])("data-v-613e6506");Object(s["t"])("data-v-613e6506");const b={class:"frame"},d=Object(s["h"])("i",{class:"fas fa-plus"},null,-1),f={class:"hint"};Object(s["r"])();const w=p((e,a,t,i,n,r)=>(Object(s["q"])(),Object(s["d"])("div",{class:"file_uploader",show:n.show},[Object(s["h"])("div",b,[Object(s["h"])("div",{class:"area",onClick:a[1]||(a[1]=(...e)=>r.onClick&&r.onClick(...e)),onDragenter:a[2]||(a[2]=(...e)=>r.checkDrop&&r.checkDrop(...e)),onDragover:a[3]||(a[3]=(...e)=>r.checkDrop&&r.checkDrop(...e)),onDrop:a[4]||(a[4]=(...e)=>r.onDrop&&r.onDrop(...e))},[d],32),Object(s["h"])("div",f,[Object(s["h"])("input",{ref:"hint",type:"text",name:"url_hint",onKeyup:a[5]||(a[5]=(...e)=>r.onEnter&&r.onEnter(...e))},null,544),Object(s["h"])("button",{ref:"submitter",class:"submit",onClick:a[6]||(a[6]=(...e)=>r.onSubmit&&r.onSubmit(...e))},"确认",512)])]),Object(s["h"])("input",{ref:"uploader",type:"file",onChange:a[7]||(a[7]=(...e)=>r.onSelect&&r.onSelect(...e))},null,544)],8,["show"])));var m={name:"Uploader",data(){return{show:!1}},props:{type:String},methods:{onClick(){var e=this.$refs.uploader;e.accept=this.type,e.click()},onEnter(e){13===e.keyCode&&this.onSubmit()},onSelect(e){var a=e.target.files;if(a&&(a=a.item(0),a)){var t=this.$refs.hint;t.file=a,t.value="file://"+a.name,t.focus(),this.onSubmit()}},onSubmit(){var e=this.$refs.hint;e.file&&e.value==="file://"+e.file.name?this.$emit("parse",e.file):this.$emit("parse",e.value)},checkDrop(e){e.preventDefault()},onDrop(e){e.preventDefault();var a=e.dataTransfer.files;if(a&&(a=a[0],a)){var t=a.name;t=t.split(".").last;var s=this.type.split(",").map(e=>e.replace(/^\.+/,""));if(s.includes(t)){var i=this.$refs.hint;i.file=a,i.value="file://"+a.name,i.focus(),this.onSubmit()}}},active(){var e=this.$refs.hint;e.file=null,e.value="",this.show=!0},deactive(){var e=this.$refs.hint;e.file=null,e.value="",this.show=!1}}};t("a647");m.render=w,m.__scopeId="data-v-613e6506";var k=m,v={name:"ParseMarkup",data(){return{pages:[],currentTab:""}},components:{Tabs:u,Uploader:k},mounted(){callPageLoaded(),this.newPage()},methods:{async onSelect(e){this.currentTab=e.key,await this.parseMarkUp(e.markup),callPageLoaded()},readLocalFile:e=>new Promise(a=>{var t=new FileReader;t.onload=()=>{a(t.result)},t.onerror=()=>{a(null)},t.readAsText(e)}),async parseMarkUp(e){PageBroadcast.emit("change-loading-hint",{name:"解析中……",action:"show"});var a=await MarkUp.fullParse(e,{toc:!0,glossary:!0,resources:!0,showtitle:!0,showauthor:!0,classname:"markup-content"});return this.$refs.articleArea.innerHTML=a.content,await this.afterMarkUp(),a.title},async parseFile(e){if(this.$refs.uploader.deactive(),e){if(String.is(e))return this.parseUrl(e);PageBroadcast.emit("change-loading-hint",{name:"读取中……",action:"show"}),await wait();var a=await this.readLocalFile(e),t=await this.parseMarkUp(a);await wait();var s={name:t,key:e.name,markup:a};this.pages.push(s),this.currentTab=s.key,await wait(),callPageLoaded()}},async parseUrl(e){PageBroadcast.emit("change-loading-hint",{name:"读取中……",action:"show"}),await wait();var a=await axios.get(e);a=a.data;var t=await this.parseMarkUp(a);await wait();var s={name:t,key:file.name,markup:a};this.pages.push(s),this.currentTab=s.key,await wait(),callPageLoaded()},newPage(){this.$refs.uploader.active()},onClick(e){onVueHyperLinkTriggered(this,e)},async closeTab(e){var a=-1;if(this.pages.some((t,s)=>{if(e.key===t.key)return a=s,!0}),!(a<0))if(this.pages.splice(a,1),0===this.pages.length)this.$refs.articleArea.innerHTML="",await wait(),this.newPage();else{let e;e=0===a?this.pages[0]:this.pages[a-1],await this.parseMarkUp(e.markup),this.currentTab=e.key,callPageLoaded()}}}};t("efbe");v.render=n,v.__scopeId="data-v-4e9c4353";a["default"]=v},efbe:function(e,a,t){"use strict";t("266f")},fe7e:function(e,a,t){}}]);
//# sourceMappingURL=chunk-52bc38f8.js.map