(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ae8ae3f"],{"0390":function(e,a,t){},"30d8":function(e,a,t){"use strict";t("ba31")},ba31:function(e,a,t){},dcfb:function(e,a,t){"use strict";t.r(a);var s=t("79c4");const n=Object(s["D"])("data-v-facf0e18"),i=n((e,a,t,n,i,r)=>{const c=Object(s["x"])("Crumb"),l=Object(s["x"])("Tabs"),o=Object(s["x"])("Uploader");return Object(s["q"])(),Object(s["d"])(s["a"],null,[Object(s["h"])(c,{target:"tools"}),Object(s["h"])(l,{tabs:i.pages,showNewTab:!0,selected:i.currentTab,onSelect:r.onSelect,onNewTab:r.newPage,onClose:r.closeTab},null,8,["tabs","selected","onSelect","onNewTab","onClose"]),Object(s["h"])(o,{ref:"uploader",type:".mu,.md",onParse:r.parseFile},null,8,["onParse"]),Object(s["h"])("div",{ref:"articleArea",class:"content-container",onClick:a[1]||(a[1]=(...e)=>r.onClick&&r.onClick(...e))},null,512)],64)}),r={class:"tab_container"},c=Object(s["h"])("i",{class:"fas fa-plus"},null,-1);function l(e,a,t,n,i,l){return Object(s["q"])(),Object(s["d"])("div",r,[(Object(s["q"])(!0),Object(s["d"])(s["a"],null,Object(s["w"])(t.tabs,e=>(Object(s["q"])(),Object(s["d"])("div",{class:"tab_item",selected:e.key===t.selected,onClick:a=>l.select(e),onDblclick:a=>l.close(e)},Object(s["z"])(e.name),41,["selected","onClick","onDblclick"]))),256)),t.showNewTab?(Object(s["q"])(),Object(s["d"])("div",{key:0,class:"tab_item tab_new_item",onClick:a[1]||(a[1]=(...e)=>l.newTab&&l.newTab(...e))},[c])):Object(s["e"])("",!0)])}t("0390");var o={name:"Tabs",props:{tabs:Array,showNewTab:Boolean,selected:String},methods:{select(e){this.$emit("select",e)},newTab(){this.$emit("newTab")},close(e){this.$emit("close",e)}}};o.render=l;var h=o;const p=Object(s["D"])("data-v-114da750");Object(s["t"])("data-v-114da750");const u={class:"frame"},d=Object(s["h"])("i",{class:"fas fa-plus"},null,-1),b={class:"hint"};Object(s["r"])();const f=p((e,a,t,n,i,r)=>(Object(s["q"])(),Object(s["d"])("div",{class:"file_uploader",show:i.show},[Object(s["h"])("div",u,[Object(s["h"])("div",{class:"area",onClick:a[1]||(a[1]=(...e)=>r.onClick&&r.onClick(...e)),onDragenter:a[2]||(a[2]=(...e)=>r.checkDrop&&r.checkDrop(...e)),onDragover:a[3]||(a[3]=(...e)=>r.checkDrop&&r.checkDrop(...e)),onDrop:a[4]||(a[4]=(...e)=>r.onDrop&&r.onDrop(...e))},[d],32),Object(s["h"])("div",b,[Object(s["h"])("input",{ref:"hint",type:"text",name:"url_hint",onKeyup:a[5]||(a[5]=(...e)=>r.onEnter&&r.onEnter(...e))},null,544),Object(s["h"])("button",{ref:"submitter",class:"submit",onClick:a[6]||(a[6]=(...e)=>r.onSubmit&&r.onSubmit(...e))},"确认",512)])]),Object(s["h"])("input",{ref:"uploader",type:"file",onChange:a[7]||(a[7]=(...e)=>r.onSelect&&r.onSelect(...e))},null,544)],8,["show"])));var w={name:"Uploader",data(){return{show:!1}},props:{type:String},methods:{onClick(){var e=this.$refs.uploader;e.accept=this.type,e.click()},onEnter(e){13===e.keyCode&&this.onSubmit()},onSelect(e){var a=e.target.files;if(a&&(a=a.item(0),a)){var t=this.$refs.hint;t.file=a,t.value="file://"+a.name,t.focus()}},onSubmit(){var e=this.$refs.hint;e.file&&e.value==="file://"+e.file.name?this.$emit("parse",e.file):this.$emit("parse",e.value)},checkDrop(e){e.preventDefault()},onDrop(e){e.preventDefault();var a=e.dataTransfer.files;if(a&&(a=a[0],a)){var t=a.name;t=t.split(".").last;var s=this.type.split(",").map(e=>e.replace(/^\.+/,""));if(s.includes(t)){var n=this.$refs.hint;n.file=a,n.value="file://"+a.name,n.focus()}}},active(){var e=this.$refs.hint;e.file=null,e.value="",this.show=!0},deactive(){var e=this.$refs.hint;e.file=null,e.value="",this.show=!1}}};t("30d8");w.render=f,w.__scopeId="data-v-114da750";var v=w,m={name:"ParseMarkup",data(){return{pages:[],currentTab:""}},components:{Tabs:h,Uploader:v},mounted(){callPageLoaded(),this.newPage()},methods:{async onSelect(e){this.currentTab=e.key,await this.parseMarkUp(e.markup),callPageLoaded()},readLocalFile:e=>new Promise(a=>{var t=new FileReader;t.onload=()=>{a(t.result)},t.onerror=()=>{a(null)},t.readAsText(e)}),async parseMarkUp(e){var a=new BroadcastChannel("change-loading-hint");a.postMessage({name:"解析中……",action:"show"});var t=await MarkUp.fullParse(e,{toc:!0,glossary:!0,resources:!0,showtitle:!0,showauthor:!0,classname:"markup-content"});return this.$refs.articleArea.innerHTML=t.content,await this.afterMarkUp(),t.title},async parseFile(e){if(this.$refs.uploader.deactive(),e){if(String.is(e))return this.parseUrl(e);var a=new BroadcastChannel("change-loading-hint");a.postMessage({name:"读取中……",action:"show"}),await wait();var t=await this.readLocalFile(e),s=await this.parseMarkUp(t);await wait();var n={name:s,key:e.name,markup:t};this.pages.push(n),this.currentTab=n.key,await wait(),callPageLoaded()}},async parseUrl(e){var a=new BroadcastChannel("change-loading-hint");a.postMessage({name:"读取中……",action:"show"}),await wait();var t=await axios.get(e);t=t.data;var s=await this.parseMarkUp(t);await wait();var n={name:s,key:file.name,markup:t};this.pages.push(n),this.currentTab=n.key,await wait(),callPageLoaded()},newPage(){this.$refs.uploader.active()},onClick(e){onVueHyperLinkTriggered(this,e)},async closeTab(e){var a=-1;if(this.pages.some((t,s)=>{if(e.key===t.key)return a=s,!0}),!(a<0))if(this.pages.splice(a,1),0===this.pages.length)this.$refs.articleArea.innerHTML="",await wait(),this.newPage();else{let e;e=0===a?this.pages[0]:this.pages[a-1],await this.parseMarkUp(e.markup),this.currentTab=e.key,callPageLoaded()}}}};t("ea2a");m.render=i,m.__scopeId="data-v-facf0e18";a["default"]=m},ea2a:function(e,a,t){"use strict";t("f9f2")},f9f2:function(e,a,t){}}]);
//# sourceMappingURL=chunk-5ae8ae3f.js.map