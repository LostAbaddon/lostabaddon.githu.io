MarkUp.addExtension({name:"CC&Like",parse:(e,s,t)=>{var n=e.match(/^[ 　\t]*COPYRIGHT:[ 　\t]*(.*?)[ 　\t]*$/);return n?(s.metas.others=s.metas.others||{},s.metas.others.CopyRight=n[1],["",!0]):(n=e.match(/^[ 　\t]*LIKECOIN:[ 　\t]*(.*?)[ 　\t]*$/),n?(s.metas.others=s.metas.others||{},s.metas.others.LikeCoin=n[1],["",!0]):[e,!1])}},0,-1),MarkUp.addExtension({name:"Cite&Repost",parse:(e,s,t)=>{var n=!1;e=e.replace(/<\[(\d+)\]>/g,(h,i)=>{var p="CITE-"+MarkUp.generateRandomKey();return t[p]='<a href="#CITE-'+i+'">['+i+"]</a>",n=!0,"%"+p+"%"});var a=e.match(/^[ 　\t]*CITE-(\d+):[ 　\t]*(.*?)[ 　\t]*$/);if(a){s.metas.others=s.metas.others||{},s.metas.others.Cites=s.metas.others.Cites||[];var r=a[1]*1;if(!isNaN(r))return s.metas.others.Cites[r]=a[2],["",!0]}return a=e.match(/^[ 　\t]*REPOST:[ 　\t]*(.*?)[ 　\t]*$/),a?(s.metas.others=s.metas.others||{},s.metas.others.Reposts=s.metas.others.Reposts||[],s.metas.others.Reposts.push(a[1]),["",!0]):[e,n]}},0,-1),MarkUp.addExtension({name:"Cite&Repost",parse:(e,s)=>{var t=[],n=!1,a=!1;return s.metas.others&&(!!s.metas.others.Cites&&s.metas.others.Cites.length>0&&(n=!0,t.push('<section class="cite-list"><h1><a name="CITE-LIST">\u5F15\u7528\u6587\u732E</a></h1>'),s.metas.others.Cites.forEach((r,h)=>{!r||t.push('<p><a class="cite-marker" name="CITE-'+h+'">['+h+"]</a>: "+MarkUp.parseLine(r,s)+"</p>")}),t.push("</section>")),!!s.metas.others.Reposts&&s.metas.others.Reposts.length>0&&(a=!0,t.push('<section class="repost-list"><h1><a name="REPOST-LIST">\u8F6C\u8F7D\u5E73\u53F0</a></h1><ul>'),s.metas.others.Reposts.forEach(r=>{t.push('<li><a href="'+r+'" target="_blank">'+r+"</a></li>")}),t.push("</ul></section>"))),e=e.replace(/<\/article>[ 　\t\n\r]*$/,t.join("")+"</article>"),t.length>0&&(t=[],n&&t.push('<p class="content-item level-1"><span class="content-indent"></span><a class="content-link" href="#CITE-LIST">\u5F15\u7528\u6587\u732E</a></p>'),a&&t.push('<p class="content-item level-1"><span class="content-indent"></span><a class="content-link" href="#REPOST-LIST">\u8F6C\u8F7D\u5E73\u53F0</a></p>'),e=e.replace(/(<aside class="content-table">)([\w\W]*?)(<\/aside>)/g,(r,h,i,p)=>h+i+t.join("")+p)),e}},2,-1),MarkUp.addExtension({name:"ASCII-Chars",parse:(e,s,t)=>{var n=!1;if(!s.mainParser)return[e,n];var a=0,r=[];return e.replace(/(<.*?>|%.*?%|\[.*?\]|\{.*?\})/gi,(h,i,p)=>{p>a&&r.push([!1,e.substring(a,p)]),r.push([!0,h]),a=p+h.length}),a<e.length&&r.push([!1,e.substring(a,e.length)]),e=[],r.forEach(h=>{if(!h[0]){var i=h[1].replace(/[\w \-\+\.,:;\?!\*`@#$%^&\(\)\[\]\{\}=_'"\\\/<>\|]+/g,p=>p.match(/[a-zA-Z]/)?'</span><span class="english">'+p.trim()+'</span><span class="normal">':p);i='<span class="normal">'+i+"</span>",h[1]=i.replace(/<span class="normal"> *<\/span>/g,"")}}),r.forEach(h=>{e.push(h[1])}),e=e.join(""),[e,n]}},0,999);
